name: Get PyPI Version

on:
  workflow_call:

jobs:
  get-version:
    name: Get the Version for the Package
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Source Code
      uses: actions/checkout@v4

    - name: Get Version
      id: get_version
      run: |
        CURRENT_VERSION=$(grep version setup.cfg | sed -r 's/version = (.*)/\1/')
        NEW_VERSION=$CURRENT_VERSION.$GITHUB_RUN_NUMBER.$GITHUB_RUN_ATTEMPT
        echo NEW_VERSION
        echo $NEW_VERSION
        echo "PACKAGE_VERSION=${NEW_VERSION}" >> $GITHUB_OUTPUT

    outputs:
      PACKAGE_VERSION: ${{ steps.get_version.outputs.PACKAGE_VERSION }}
